<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Admin Panel</title>

    <link rel="stylesheet" href="./css/notify.css" />
    <link rel="stylesheet" href="./css/notify_compose.css" />
    <link rel="stylesheet" href="./css/admin.css" />
    <link rel="stylesheet" href="./css/font.css" />
  </head>

  <body>
    <div class="sidebar">
      <h2>ADMIN</h2>

      <div class="menu" id="sideMenu">
        <button class="menu-btn" data-tab="users" onclick="show('users')">
          üë§ Qu·∫£n l√Ω user
        </button>
        <button class="menu-btn" data-tab="clients" onclick="show('clients')">
          üñ•Ô∏è Qu·∫£n l√Ω Clients
        </button>
        <button class="menu-btn" data-tab="notify" onclick="show('notify')">
          üì¢ G·ª≠i th√¥ng b√°o
        </button>
        <button class="menu-btn" data-tab="logs" onclick="show('logs')">
          üìú L·ªãch s·ª≠
        </button>
        <button class="menu-btn" data-tab="logout" onclick="logout()">
          üö™ ƒêƒÉng xu·∫•t
        </button>
      </div>

      <!-- ‚úÖ VERSION (bottom-left) -->
      <div class="sidebar-footer">
        <div id="appVersion" class="app-version">v0.0.0</div>
      </div>
    </div>

    <div class="content">
      <!-- USERS -->
      <div id="users" class="page page-scroll">
        <div class="page-header">
          <h3>Qu·∫£n l√Ω User</h3>
          <button class="ghost w160" id="btnRefreshUsersAll">üîÑ Refresh</button>
        </div>

        <input id="u_name" placeholder="Username" autocomplete="off" />
        <input
          id="u_pass"
          placeholder="Password"
          type="password"
          autocomplete="off"
        />
        <select id="u_role">
          <option value="user">User</option>
          <option value="admin">Admin</option>
        </select>

        <div class="row-flex" style="align-items: center; margin-top: 6px">
          <button class="primary w220" id="addBtn">Th√™m user</button>
          <div style="flex: 1"></div>
          <div class="muted count-right" id="usersCount">Users: 0</div>
        </div>

        <div class="table-scroll table-scroll--users">
          <table>
            <thead>
              <tr>
                <th>Username</th>
                <th>Role</th>
                <th>T·∫°o l√∫c</th>
                <th>T·∫°o b·ªüi</th>
                <th>C·∫≠p nh·∫≠t l√∫c</th>
                <th>C·∫≠p nh·∫≠t b·ªüi</th>
                <th>Thao t√°c</th>
              </tr>
            </thead>
            <tbody id="userList"></tbody>
          </table>
        </div>

        <!-- ‚úÖ ADMIN AUDIT (ROOT ONLY) -->
        <section id="adminAuditSection" class="section" style="display: none">
          <div class="muted" style="margin-bottom: 8px">
            * Ch·ªâ ROOT admin m·ªõi th·∫•y m·ª•c n√†y.
          </div>

          <div class="section-title-row">
            <div class="section-title">L·ªãch s·ª≠ thao t√°c admin</div>
            <div id="adminAuditCount" class="muted">T·ªïng: 0</div>
          </div>

          <div
            class="table-scroll table-scroll--audit"
            style="margin-top: 10px"
          >
            <table>
              <thead>
                <tr>
                  <th style="width: 60px">#</th>
                  <th style="width: 170px">Th·ªùi gian</th>
                  <th style="width: 140px">Admin</th>
                  <th style="width: 160px">H√†nh ƒë·ªông</th>
                  <th style="width: 140px">Target</th>
                  <th>Ghi ch√∫</th>
                </tr>
              </thead>
              <tbody id="adminAuditList"></tbody>
            </table>
          </div>
        </section>

        <!-- ‚úÖ LOGIN LOGS (ROOT ONLY) -->
        <section id="loginLogsSection" class="section" style="display: none">
          <div class="section-title-row" style="margin-top: 6px">
            <div class="section-title">L·ªãch s·ª≠ ƒëƒÉng nh·∫≠p</div>
            <div class="muted" id="loginLogsCount">T·ªïng: 0</div>
          </div>

          <div class="row-flex" style="align-items: center">
            <input
              id="loginLogSearch"
              placeholder="T√¨m theo username / IP / m√°y / role..."
              autocomplete="off"
            />
          </div>

          <div class="table-scroll table-scroll--loginlogs">
            <table>
              <thead>
                <tr>
                  <th style="width: 60px">#</th>
                  <th style="width: 170px">Th·ªùi gian</th>
                  <th style="width: 140px">Username</th>
                  <th style="width: 90px">Role</th>
                  <th>Thi·∫øt b·ªã</th>
                  <th style="width: 140px">IP</th>
                  <th style="width: 180px">Platform</th>
                </tr>
              </thead>
              <tbody id="loginLogList"></tbody>
            </table>
          </div>
        </section>
      </div>

      <!-- CLIENTS -->
      <div id="clients" class="page page-scroll" style="display: none">
        <h3>Qu·∫£n l√Ω Clients</h3>

        <div class="row-flex">
          <div class="row-left">
            <input
              id="clientSearchAdmin"
              placeholder="T√¨m client theo name / ip / id..."
            />
            <button class="ghost w160" id="btnRefreshClients">
              üîÑ Refresh
            </button>
          </div>

          <div class="row-right">
            <div class="muted" id="clientsCount">clients: 0</div>
          </div>
        </div>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th style="width: 60px">STT</th>
                <th>Name (s·ª≠a ƒë∆∞·ª£c)</th>
                <th style="width: 150px">Tr·∫°ng th√°i</th>
                <th style="width: 180px">IP client</th>
                <th style="width: 170px">Thao t√°c</th>
              </tr>
            </thead>
            <tbody id="clientListAdmin"></tbody>
          </table>
        </div>
      </div>

      <!-- NOTIFY -->
      <div id="notify" class="page" style="display: none">
        <div id="composeMountAdmin"></div>
      </div>

      <!-- LOG -->
      <div id="logs" class="page page-scroll" style="display: none">
        <h3>L·ªãch s·ª≠ th√¥ng b√°o</h3>

        <div class="row-flex">
          <div class="row-left">
            <input
              class="logSearch"
              id="logSearch"
              placeholder="T√¨m theo client/name/ip/ng∆∞·ªùi g·ª≠i/n·ªôi dung..."
            />
            <button class="ghost w160" id="btnRefreshLogs">üîÑ Refresh</button>
            <button class="primary w160" id="btnExportExcel">
              ‚¨á Export Excel
            </button>
          </div>

          <div class="row-right">
            <div class="muted" id="logsCount">T·ªïng: 0</div>
          </div>
        </div>

        <div
          class="row-flex"
          style="
            align-items: center;
            gap: 10px;
            margin: 10px 0;
            flex-wrap: wrap;
          "
        >
          <select id="logByFilter" class="w220">
            <option value="">-- Ng∆∞·ªùi g·ª≠i --</option>
          </select>

          <select id="logClientFilter" class="w260">
            <option value="">-- Client --</option>
          </select>

          <input id="logFrom" class="w160" type="date" />
          <input id="logTo" class="w160" type="date" />

          <div style="flex: 1"></div>

          <button class="ghost w160" id="btnPrevLogs">‚¨Ö Tr∆∞·ªõc</button>
          <div class="muted" id="logsPageInfo">Trang 1/1 ‚Ä¢ 50/trang</div>
          <button class="ghost w160" id="btnNextLogs">Sau ‚û°</button>
        </div>

        <div class="table-scroll">
          <table>
            <thead>
              <tr>
                <th style="width: 60px">#</th>
                <th style="width: 170px">Th·ªùi gian</th>
                <th style="width: 120px">Ng∆∞·ªùi g·ª≠i</th>
                <th style="width: 200px">Client</th>
                <th style="width: 140px">IP</th>
                <th style="width: 90px">Dur</th>
                <th style="width: 110px">Status</th>
                <th>N·ªôi dung</th>
              </tr>
            </thead>
            <tbody id="logList"></tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- MESSAGE MODAL -->
    <div id="msgOverlay" class="modal-overlay" role="dialog" aria-modal="true">
      <div class="modal">
        <h4>Th√¥ng b√°o</h4>
        <p id="msgText"></p>
        <div class="actions2">
          <button class="btn btn-ok" id="msgOk">OK</button>
        </div>
      </div>
    </div>

    <!-- EDIT USER MODAL -->
    <div id="editOverlay" class="modal-overlay" role="dialog" aria-modal="true">
      <div class="modal">
        <h4>S·ª≠a user</h4>

        <div class="row">
          <div class="muted">Username</div>
          <input id="e_username" disabled />
        </div>

        <div class="row">
          <div class="muted">Role</div>
          <select id="e_role">
            <option value="user">User</option>
            <option value="admin">Admin</option>
          </select>
        </div>

        <div class="row">
          <div class="muted">Password (ƒë·ªÉ tr·ªëng n·∫øu kh√¥ng ƒë·ªïi)</div>
          <input
            id="e_pass"
            type="password"
            placeholder="Nh·∫≠p password m·ªõi..."
          />
        </div>

        <div class="actions2">
          <button class="btn btn-cancel" id="editCancel">H·ªßy</button>
          <button class="btn btn-ok" id="editSave">L∆∞u</button>
        </div>
      </div>
    </div>

    <!-- DELETE USER MODAL -->
    <div id="delOverlay" class="modal-overlay" role="dialog" aria-modal="true">
      <div class="modal">
        <h4>X√≥a user</h4>
        <p id="delText"></p>
        <div class="actions2">
          <button class="btn btn-cancel" id="delCancel">H·ªßy</button>
          <button class="btn btn-danger" id="delOk">X√≥a</button>
        </div>
      </div>
    </div>

    <!-- DELETE CLIENT MODAL -->
    <div
      id="delClientOverlay"
      class="modal-overlay"
      role="dialog"
      aria-modal="true"
    >
      <div class="modal">
        <h4>X√≥a client</h4>
        <p id="delClientText"></p>
        <div class="actions2">
          <button class="btn btn-cancel" id="delClientCancel">H·ªßy</button>
          <button class="btn btn-danger" id="delClientOk">X√≥a</button>
        </div>
      </div>
    </div>

    <!-- libs -->
    <script src="./js/notify_ui.js"></script>
    <script src="./js/admin_page.js" defer></script>
  </body>
</html>
